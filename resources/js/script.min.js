!function(a){a.fn.extend({iconCaptcha:function(c){var t={captchaTheme:[""],captchaFontFamily:"",captchaClickDelay:1e3,captchaHoverDetection:!0,showCredits:!0,enableLoadingAnimation:!1,loadingAnimationDelay:2e3,requestIconsDelay:1500,captchaAjaxFile:"../php/captcha-request.php",captchaMessages:{header:"Select the image that does not belong in the row",correct:{top:"Great!",bottom:"You do not appear to be a robot."},incorrect:{top:"Oops!",bottom:"You've selected the wrong image."}}},e=a.extend(t,c);return this.each(function(c){function t(a){var t="light";void 0==e.captchaTheme[c]||"dark"!==e.captchaTheme[c]&&"light"!==e.captchaTheme[c]||(t=e.captchaTheme[c].toLowerCase()),f=0,m.addClass("captcha-theme-"+t),v||o();var s=m.find(".captcha-modal__icons");e.requestIconsDelay&&e.requestIconsDelay>0&&!v?(a||r(s),setTimeout(function(){i(c,t,s,!0)},e.requestIconsDelay)):i(c,t,s,a)}function i(c,t,i,o){a.ajax({url:e.captchaAjaxFile,type:"post",data:{cID:c,rT:1,tM:t},success:function(t){t&&($data=JSON.parse(t),o||r(i),g=new Date,m.find(".captcha-image").each(function(t,o){a(this).css("background-image","url("+e.captchaAjaxFile+"?cid="+c+"&hash="+$data[t]+")"),a(this).attr("icon-hash",$data[t]),d(a(this),i)}),v||m.trigger("init",[{captcha_id:c}]),v=!0)},error:function(a,c,t){console.log(c,t),h()}})}function o(){e.captchaFontFamily?m.css("font-family",e.captchaFontFamily):a("body").append('\x3c!-- Icon Captcha default font --\x3e<link href="https://fonts.googleapis.com/css?family=Roboto:400,500" rel="stylesheet">'),m.html(["<div class='captcha-modal'>","<div class='captcha-modal__header'>","<span>"+(e.captchaMessages.header&&e.captchaMessages.header?e.captchaMessages.header:"Select the image that does not belong in the row")+"</span>","</div>","<div class='captcha-modal__icons'>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","</div>","<div class='captcha-modal__credits' alt='IconCaptcha by Fabian Wennink' title='IconCaptcha by Fabian Wennink'>","<a href='https://www.fabianwennink.nl/projects/IconCaptcha/v2/' target='_blank' rel='follow'>IconCaptcha</a> &copy;","</div>","<input type='hidden' name='captcha-hf' required />","<input type='hidden' name='captcha-idhf' value='"+c+"' required />","</div>"].join("\n")),e.showCredits&&m.addClass("captcha-credits")}function s(t){var i=t.attr("icon-hash");i&&(m.find('input[name="captcha-hf"]').attr("value",i),m.find('input[name="captcha-idhf"]').attr("value",c),a.ajax({url:e.captchaAjaxFile,type:"post",data:{cID:c,pC:i,rT:2},success:function(a){"1"===a?n():h()},error:function(a,c,t){h()}}))}function n(){m.find(".captcha-modal__icons").empty(),m.addClass("captcha-success"),m.find(".captcha-modal__icons").html('<div class="captcha-modal__icons-title">'+(e.captchaMessages.correct&&e.captchaMessages.correct.top?e.captchaMessages.correct.top:"Great!")+'</div><div class="captcha-modal__icons-subtitle">'+(e.captchaMessages.correct&&e.captchaMessages.correct.bottom?e.captchaMessages.correct.bottom:"You do not appear to be a robot.")+"</div>"),m.trigger("success",[{captcha_id:c}])}function h(){m.find(".captcha-modal__icons").empty(),m.addClass("captcha-error"),m.find(".captcha-modal__icons").html('<div class="captcha-modal__icons-title">'+(e.captchaMessages.incorrect&&e.captchaMessages.incorrect.top?e.captchaMessages.incorrect.top:"Oops!")+'</div><div class="captcha-modal__icons-subtitle">'+(e.captchaMessages.incorrect&&e.captchaMessages.incorrect.bottom?e.captchaMessages.incorrect.bottom:"You've selected the wrong image.")+"</div>"),m.trigger("error",[{captcha_id:c}]),setTimeout(p,3e3)}function p(){m.removeClass("captcha-error"),m.find("input").attr("value",null),m.find(".captcha-modal__icons").html(["<div class='captcha-loader'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>","<div class='captcha-image'></div>"].join("\n")),m.find(".captcha-modal__icons > .captcha-image").attr("icon-hash",null),t(!0),m.trigger("refreshed",[{captcha_id:c}])}function d(a,c){var t=a.css("background-image").match(/\((.*?)\)/)[1].replace(/('|")/g,""),e=new Image;e.onload=function(){5===(f+=1)&&c&&l(c)},e.src=t,e.complete&&e.onload()}function r(a){a.addClass("captcha-opacity"),a.prepend('<div class="captcha-loader"></div>')}function l(a){a.removeClass("captcha-opacity"),a.find(".captcha-loader").remove()}var m=a(this),g=0,u=!1,v=!1,f=0;t(!1),m.on("click",".captcha-modal__icons > .captcha-image",function(t){if(!(new Date-g<=e.captchaClickDelay)&&(!e.captchaHoverDetection||u)){var i=t.pageX-a(t.target).offset().left,o=t.pageY-a(t.target).offset().top;if(i&&o){var n=a(this),h=m.find(".captcha-modal__icons");h.hasClass("captcha-opacity")||(m.trigger("selected",[{captcha_id:c}]),!0===e.enableLoadingAnimation?(r(h),setTimeout(function(){s(n)},e.loadingAnimationDelay)):s(n))}}}).on({mouseenter:function(){u||(u=!0)},mouseleave:function(){u&&(u=!1)}},m)})}})}(jQuery);